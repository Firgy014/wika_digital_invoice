<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <data>

        <!-- form -->
        <record id="view_wika_account_move_form_inherit" model="ir.ui.view">
            <field name="name">wika.account.move.inherit.view.form</field>
            <field name="model">account.move</field>
            <field name="inherit_id" ref="account.view_move_form"/>
            <field name="arch" type="xml">
                <!-- state -->
                <xpath expr="//field[@name='state']" position="attributes">
                    <attribute name="statusbar_visible">draft,upload,approve</attribute>
                </xpath>

                <!-- button -->
                <xpath expr="/form/header/button[@name='action_invoice_sent']" position="before">
                    <button name="action_print_invoice" string="Print" type="object" class="oe_highlight"/>
                    <button name="action_submit" string="SUBMIT" type="object" class="oe_highlight" 
                    attrs="{'invisible': ['|', ('state', '=', 'upload'), 
                        ('state', '=', 'approve')]}"/>
                    <button name="action_approve" string="APPROVE" type="object" class="oe_highlight" 
                    attrs="{'invisible': ['|', ('state', '=', 'draft'), 
                        ('state', '=', 'approve')]}"/>
                     <button name="action_reject" string="REJECT" type="object" class="oe_highlight" 
                    attrs="{'invisible': ['|', ('state', '=', 'draft'), 
                        ('state', '=', 'approve') ]}"/>
                </xpath>
                <xpath expr="/form/header/button[@name='action_post']" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>
                <xpath expr="/form/header/button[2]" position="attributes">
                    <attribute name="invisible">1</attribute>
                </xpath>

                <!-- field -->
                <xpath expr="//field[@name='partner_id']" position="after">
                    <field name="bap_id" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                    <field name="pr_id" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                </xpath>
                <xpath expr="//field[@name='invoice_date']" position="after">
                    <field name="branch_id" domain="[('biro', '=', False)]" 
                        attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                    <field name="department_id" domain="[('biro', '=', True), ('parent_id', '=', branch_id)]" 
                        attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                    <field name="project_id" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                    <field name="step_approve" invisible="1"/>
                </xpath>
                <xpath expr="//field[@name='pr_id']" position="after">
                    <field name="ref" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                </xpath>
                <xpath expr="//field[@name='date']" position="after">
                    <field name="payment_reference" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                </xpath> 
                <xpath expr="//field[@name='partner_bank_id']" position="after">
                    <field name="invoice_date_due" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}"/>
                </xpath>   
                <xpath expr="//notebook/page[@name='other_info']" position="after">
                    <page string="List Document">
                        <field name="document_ids" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}">
                            <tree>
                                <field name="document_id"/>
                                <field name="document" widget="binary_button" filename="filename"/>
                                <field name="filename" invisible="1"/>
                                <field name="state"/>
                            </tree>
                            <form>
                                <group>
                                    <field name="document" widget="pdf_viewer" filename="filename"/>
                                    <field name="filename" invisible="1"/>
                                    <field name="state" invisible="1"/>
                                </group>
                            </form>
                        </field>
                    </page>
                    <page string="List Approval">
                        <field name="history_approval_ids" attrs="{'readonly': [('state', 'in', ['upload', 'approve'])]}">
                            <tree string="List Approval">
                                <field name="user_id"/>
                                <field name="groups_id"/>
                                <field name="date"/>
                                <field name="note"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>
    </data>
    
</odoo>
