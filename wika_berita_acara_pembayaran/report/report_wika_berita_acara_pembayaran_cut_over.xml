<odoo>

    <template id="report_wika_berita_acara_pembayaran_cut_over">
        <t t-foreach="docs" t-as="o">
        <t t-call="web.html_container">
            <t t-set="data_report_margin_top" t-value="8"/>
            <t t-set="data_report_header_spacing" t-value="9"/>
            <t t-set="data_report_dpi" t-value="110"/>

            <t t-call="web.internal_layout">
                <div class="page">
                    <div style="text-align: center; margin-top: -5px; font-size: 14px;">
                        <h4>BERITA ACARA PEMBAYARAN CUT OVER (BAP CUT OVER)</h4>
                        <strong>Nomor :</strong> <span t-field="o.name"/> 
                    </div>
                    <div>
                        <table style="width:80%; margin:auto;" class="table table-borderless">
                            <tr>
                                <th scope="col" style="width: auto;">Pada hari ini,</th>
                                <th scope="col" style="width: auto;">
                                    <td style="padding: 2px 0;">
                                        <t t-esc="{
                                            'Monday': 'Senin',
                                            'Tuesday': 'Selasa',
                                            'Wednesday': 'Rabu',
                                            'Thursday': 'Kamis',
                                            'Friday': 'Jumat',
                                            'Saturday': 'Sabtu',
                                            'Sunday': 'Minggu'
                                        }[o.bap_date.strftime('%A')] if o.bap_date else ''"/>
                                    </td>
                                </th>
                                <th scope="col" style="width: auto;">Tanggal,</th>
                                <th scope="col" style="width: auto;">
                                    <td style="padding: 2px;"><t t-esc="o.bap_date.strftime('%d')" /></td>
                                </th>
                                <th scope="col" style="width: auto;">Bulan,</th>
                                <th scope="col" style="width: auto;">
                                    <td style="padding: 2px;"><t t-esc="{
                                        '01': 'Januari',
                                        '02': 'Februari',
                                        '03': 'Maret',
                                        '04': 'April',
                                        '05': 'Mei',
                                        '06': 'Juni',
                                        '07': 'Juli',
                                        '08': 'Agustus',
                                        '09': 'September',
                                        '10': 'Oktober',
                                        '11': 'November',
                                        '12': 'Desember'
                                    }[o.bap_date.strftime('%m')] if o.bap_date else ''"/>
                                    </td>
                                </th>
                                <th scope="col" style="width: auto;">Tahun,</th>
                                <th scope="col" style="width: auto;">
                                    <td style="padding: 2px;"><t t-esc="o.bap_date.strftime('%Y')" /></td>
                                </th>
                                <th scope="col" style="width: auto;">yang bertanda - tangan dibawah ini:</th>
                            </tr>
                        </table>
                    </div>
                    <div class="d-flex justify-content-center" style="width: 100%;">
                        <table class="table table-borderless" style="width:100%;">
                            <tbody>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Nama</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.signatory_name"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Jabatan</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;">
                                        <p>
                                            <strong>Manajer Proyek</strong> <t t-esc="o.project_id.name"/>
                                        </p>
                                    </td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Sehubungan dengan</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Pekerjaan</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.job"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Proyek</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.project_id.name"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Nomor PO</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.po_id.name"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Nomor Kontrak</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.sap_doc_number"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Tanggal Kontrak</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.begin_date"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Nilai Kontrak (exlude PPN)</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;">Rp.<t t-esc="'{:,.2f}'.format(o.po_id.amount_untaxed)"/></td>
                                </tr>
                                <tr style="text-align: left;">
                                    <td style="padding: 1px;">Business Partner</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.partner_id.name"/></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div>
                        <p style="text-align: left; font-size: 14px;">
                            Dengan ini menyatakan bahwa atas pekerjaan sesuai dengan Nomor PO dan Kontrak di atas sudah dilakukan Proses Invoicenya, dengan rincian sebagai berikut :
                        </p>
                    </div>
                    <div style="margin-top: -20px;">
                        <style>
                            .table tbody th,
                            .table tbody td,
                            .table tbody p {
                                font-size: 14px; /* Sesuaikan ukuran teks yang diinginkan */
                            }
                        </style>
                        <table class="table table-borderless" style="width:100%">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <th scope="col" style="width: auto;"></th>
                                    <!-- <th scope="col" style="width: 14%;"></th> -->
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <!-- <th style="padding: 1px;" scope="row">1.</th>
                                    <td style="padding: 1px;"><strong>NILAI RETENSI</strong></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td> -->
                                </tr>
                                <tr>
                                    <!-- <th scope="row" style="padding: 1px;">1.1</th>
                                    <td style="padding: 1px;">Yang lalu</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.last_retensi_total)"/></td> -->
                                </tr>
                                <tr>
                                    <!-- <th scope="row" style="padding: 1px;">1.2</th>
                                    <td style="padding: 1px;">Saat ini</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="o.amount_pecentage_retensi"/>%</td>
                                    <td style="padding: 1px;">x</td>
                                    <td style="padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.total_amount) if o.total_amount else 0"/></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.retensi_total)"/></td> -->
                                </tr>
                                <tr>
                                    <!-- <th style="padding: 1px;" scope="row">1.3</th>
                                    <td style="padding: 1px;">S/d saat ini</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.last_retensi_total + o.retensi_total)"/></td> -->
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row">a</th>
                                    <td style="padding: 1px;">NILAI PRESTASI s/d saat ini</td>
                                    <td style="padding: 1px;">:</td>
                                    <td style="padding: 1px;"><t t-esc="'{:,.2f}'.format((o.total_amount / o.po_id.amount_untaxed) * 100) if o.total_amount > 0 else 0"/>%</td>
                                    <td style="padding: 1px;">x</td>
                                    <td style="padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.po_id.amount_untaxed) if o.po_id.amount_untaxed else ''"/></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.total_amount)"/></td>
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row">b</th>
                                    <td style="padding: 1px;">Potongan Uang Muka s/d saat ini</td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.dp_total)"/></td>
                                </tr>
                                <t t-set="jumlah_total_netto" t-value="(o.total_amount - o.dp_total - o.retensi_total)"/>
                                <tr>
                                    <th style="padding: 1px;" scope="row">c</th>
                                    <td style="padding: 1px;">Potongan Retensi s/d saat ini</td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.retensi_total)"/></td>
                                </tr>
                                <!-- <t t-set="ppn" t-value="o.retensi_total * 0.11"/> -->
                                <tr>
                                    <th style="padding: 1px;" scope="row">d</th>
                                    <td style="padding: 1px;">Jumlah Tagihan netto s/d saat ini</td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(jumlah_total_netto) if jumlah_total_netto else ''"/></td>
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row">e</th>
                                    <td style="padding: 1px;">PPN s/d saat ini </td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.total_tax) if o.total_tax else ''"/></td>
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row">f</th>
                                    <td style="padding: 1px;">Potongan Lain-lain s/d saat ini </td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.total_pph) if o.total_pph else ''"/></td>
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row">g</th>
                                    <td style="padding: 1px;">Yang sudah diproses Invoicenya s/d saat ini </td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="text-align: right; padding: 1px;">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(o.total_pembayaran)"/></td>
                                </tr>
                                <tr>
                                    <th style="padding: 1px;" scope="row"></th>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    
                                </tr>
                                <!-- <t t-set="total_pembayaran" t-value="o.retensi_total + ppn - o.total_pph"/> -->
                                <tr>
                                    <!-- <th style="padding: 1px;" scope="row">5.</th>
                                    <td style="padding: 1px;"><strong>PEMBAYARAN</strong></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td>
                                    <td style="padding: 1px;"></td> -->
                                </tr>
                                <tr>
                                    <!-- <th style="padding: 1px;" scope="row"></th>
                                    <td style="padding: 1px;" colspan="5">PIHAK KEDUA berhak menerima pembayaran dari PIHAK KESATU sebesar</td>                                  
                                    <td style="text-align: right; padding: 1px;">=</td> -->
                                    <!-- <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(total_pembayaran) if total_pembayaran else ''"/></td> -->
                                </tr>
                                <tr>
                                    <!-- <th style="padding: 1px" scope="row"></th>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td colspan="2" style="padding: 1px">Jumlah Tagihan</td>
                                    <td style="text-align: right; padding: 1px">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(total_pembayaran) if total_pembayaran else ''"/></td> -->
                                </tr>
                                <tr>
                                    <!-- <th style="padding: 1px" scope="row"></th>
                                    <td></td>
                                    <td></td>
                                    <td></td>
                                    <td colspan="2" style="padding: 1px">Dibulatkan</td>
                                    <td style="text-align: right; padding: 1px">=</td>
                                    <td style="text-align: right; padding: 1px;">Rp. <t t-esc="'{:,.0f}'.format(total_pembayaran) if total_pembayaran else ''"/></td> -->
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <div style="text-align: center;">
                        <p style="font-size: 14px;">
                            Terbilang: <span t-esc="o.terbilang"/>
                        </p>
                    </div>
                    <div>
                        <p style="text-align: left; margin-top: -14px; font-size: 14px;">
                            Demikian Berita Acara ini dibuat dengan sebenarnya untuk dapat dipergunakan sebagaimana mestinya.
                        </p>
                    </div>
                    <div style="display: flex; justify-content: space-between; font-size: 14px; margin-top: -10px;">
                        <div style="width: fit-content;">
                            <!-- <table class="table table-borderless" style="font-size: 14px; margin-top: 10px;">
                                <tr>
                                    <td style="vertical-align: top; border: 1px solid #000; padding: 5px; display: inline-block;">
                                        <p>
                                            catatan : utk isian Nilai Prestasi sd saat ini (a), Pot UM sd<br></br>
                                            saat ini (b) dan Pot retensi sd saat ini (c) adalah dari sesuai<br></br>
                                            Nilai yang diinvoice (MIR7) terakhir sebelum menggunakan<br></br>
                                            Digital Invoice
                                        </p>
                                    </td>
                                </tr>
                            </table> -->
                        </div>
                        <div style="width: fit-content;">
                            <div style="margin-bottom: 5px;">
                                <!-- <p style="text-align: left; margin-top: 0; margin-bottom: 0px;"><strong>PIHAK PERTAMA</strong></p> -->
                                <p style="margin-top: 0px; margin-bottom: 0px;"><strong>PT WIJAYA KARYA (Persero) Tbk.</strong></p>
                                <p style="margin-top: 0px; margin-bottom: 0px;"><t t-esc="o.project_id.name"/></p>
                                <br/>
                                <br/>
                                <br/>
                                <p style="margin-top: 0px; margin-bottom: 0px;"><t t-esc="o.signatory_name"/></p>
                                <p style="margin-top: 0px; margin-bottom: 0px;"><t t-esc="o.position"/></p>
                            </div>
                        </div>
                    </div>
                </div>
            </t>
        </t>
        </t>
    </template>
</odoo>
